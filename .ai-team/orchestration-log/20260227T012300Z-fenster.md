# Fenster: Core Dev — CLI Fixes

**Timestamp:** 2026-02-27T01:23:00Z  
**Agent:** Fenster (Core Dev)  
**Branch:** squad/135-137-cli-fixes  
**Mode:** Background (claude-sonnet-4.5)  

## Work Completed

### Bugs Fixed
- **#135:** Windows EPERM on `migrate-directory`
- **#137:** `--version` shows wrong version

### Implementation
1. **safeRename() fallback (index.js)**
   - Wraps `fs.renameSync()` with catch for EPERM/EACCES
   - Fallback: `fs.cpSync()` + `fs.rmSync()`
   - Scoped to migrate-directory block only
   - Trade-off: slower than atomic rename, but solves VS Code file-locking issue

2. **Dual version display (--version flag)**
   - Shows `Package: X.X.X` (npx version)
   - Shows `Installed: X.X.X` (from squad.agent.md HTML comment)
   - Shows "not installed" if squad.agent.md missing
   - Clarifies CLI vs. installed repo version

## Testing
- **Status:** ✓ 95/95 tests passing
- **Coverage:** All existing tests still pass

## Outcomes
- **PR:** #149 opened against dev branch
- **Ready for:** merge review and testing in consumer repos

## Notes
- Windows compatibility improved for users with VS Code open during migrate-directory
- Version confusion on upgrades eliminated
